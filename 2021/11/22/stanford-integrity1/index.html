<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>「Cryptography-Boneh」:Integrity - fred&#039;s blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="fred&#039;s blog"><meta name="msapplication-TileImage" content="/img/heart.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="fred&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="这篇文章主要介绍消息验证码，即MAC (Message Auth. Code)。 文章首先介绍了secure MAC的模型和安全定义，当攻击者能伪造出新的msg&amp;#x2F;tag对时，MAC就不再安全。 文章的第二部分介绍了基于PRF的MAC构造，根据相关定理，只要PRF的输出空间足够大，且这是一个安全的PRF，则基于PRF的MAC就是安全的。 但基于PRF的MAC只能计算固定消息大小的MAC，如何利用这个"><meta property="og:type" content="blog"><meta property="og:title" content="「Cryptography-Boneh」:Integrity"><meta property="og:url" content="https://f7ed.com/2021/11/22/stanford-integrity1/"><meta property="og:site_name" content="fred&#039;s blog"><meta property="og:description" content="这篇文章主要介绍消息验证码，即MAC (Message Auth. Code)。 文章首先介绍了secure MAC的模型和安全定义，当攻击者能伪造出新的msg&amp;#x2F;tag对时，MAC就不再安全。 文章的第二部分介绍了基于PRF的MAC构造，根据相关定理，只要PRF的输出空间足够大，且这是一个安全的PRF，则基于PRF的MAC就是安全的。 但基于PRF的MAC只能计算固定消息大小的MAC，如何利用这个"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://f7ed.com/gallery/thumbnails/integrity1-cover.png"><meta property="article:published_time" content="2021-11-21T16:00:00.000Z"><meta property="article:modified_time" content="2021-12-28T06:27:36.973Z"><meta property="article:author" content="f7ed"><meta property="article:tag" content="公开课"><meta property="article:tag" content="Cryptography"><meta property="article:tag" content="PRF"><meta property="article:tag" content="Integrity"><meta property="article:tag" content="MAC"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/gallery/thumbnails/integrity1-cover.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://f7ed.com/2021/11/22/stanford-integrity1/"},"headline":"「Cryptography-Boneh」:Integrity","image":["https://f7ed.com/gallery/thumbnails/integrity1-cover.png"],"datePublished":"2021-11-21T16:00:00.000Z","dateModified":"2021-12-28T06:27:36.973Z","author":{"@type":"Person","name":"f7ed"},"publisher":{"@type":"Organization","name":"fred's blog","logo":{"@type":"ImageObject","url":"https://f7ed.com/img/f1ed_logo.png"}},"description":"这篇文章主要介绍消息验证码，即MAC (Message Auth. Code)。 文章首先介绍了secure MAC的模型和安全定义，当攻击者能伪造出新的msg&#x2F;tag对时，MAC就不再安全。 文章的第二部分介绍了基于PRF的MAC构造，根据相关定理，只要PRF的输出空间足够大，且这是一个安全的PRF，则基于PRF的MAC就是安全的。 但基于PRF的MAC只能计算固定消息大小的MAC，如何利用这个"}</script><link rel="canonical" href="https://f7ed.com/2021/11/22/stanford-integrity1/"><link rel="icon" href="/img/heart.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-M5KG3CQTSF" async></script><script><!-- hexo-inject:begin --><!-- hexo-inject:end -->window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-M5KG3CQTSF');</script><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="fred's blog" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/f1ed_logo.png" alt="fred&#039;s blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/liu">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/f7ed"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><i class="fas fa-bars"></i>「Cryptography-Boneh」:Integrity</h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="2021-11-21T16:00:00.000Z" title="2021-11-21T16:00:00.000Z">2021-11-22</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="2021-12-28T06:27:36.973Z" title="2021-12-28T06:27:36.973Z">2021-12-28</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/Cryptography-Boneh/">Cryptography-Boneh</a></span><span class="level-item"><i class="far fa-clock"></i> 31 minutes read (About 4598 words)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><div class="content"><p>这篇文章主要介绍消息验证码，即MAC (Message Auth. Code)。</p>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><p>文章首先介绍了secure MAC的模型和安全定义，当攻击者能伪造出<strong>新的</strong>msg/tag对时，MAC就不再安全。</p>
<p>文章的第二部分介绍了基于PRF的MAC构造，根据相关定理，只要PRF的输出空间足够大，且这是一个安全的PRF，则基于PRF的MAC就是安全的。</p>
<p>但基于PRF的MAC只能计算固定消息大小的MAC，如何利用这个工具构造出更大消息空间的MAC？</p>
<p>文章后半部分给出了一些主流的MAC构造：</p>
<ul>
<li>串行构造：CBC-MAC、NMAC、CMAC</li>
<li>并行构造：PMAC、HMAC（下一篇文章）</li>
<li>基于one-time MAC: CW MAC</li>
</ul>
<p>此外，文章还介绍了MAC Padding技术。</p>
<span id="more"></span>

<h1 id="Message-Auth-Codes"><a href="#Message-Auth-Codes" class="headerlink" title="Message Auth. Codes"></a>Message Auth. Codes</h1><p>本节的目标是保证消息的完整性，暂时不考虑消息机密性。</p>
<p>比如保护磁盘上的公共二进制文件不会被篡改，保护web页面上的广告消息不会被替换篡改。</p>
<p>Def: <strong>MAC</strong> I = (S, V) defined over (K, M, T) is a pair of algs:</p>
<ul>
<li>S(k, m) outputs t in T</li>
<li>V(k, m, t) outputs ‘yes’ or ‘no’</li>
</ul>
<p>MAC是一组定义在(K, M, T)上的算法(S, V)，生成tag的算法S(k, m)和验证tag的算法V(k, m, tag)。</p>
<img src="https://z3.ax1x.com/2021/11/22/Iz05F0.png" alt="MACs" style="zoom:33%;" />  

<p>消息的完整性需要发送方和接收方共享一个密钥。</p>
<p>如果是用CRC来保证消息的完整性，攻击者可以修改消息，并轻易的计算出新的CRC。</p>
<img src="https://z3.ax1x.com/2021/11/22/Iz0hoq.png" alt="Integrity requires a secret key" style="zoom:33%;" />  

<p>所以CRC可以用于检测随机错误（信道噪声），而不能用于检测恶意修改。</p>
<h2 id="Secure-MACs-Model"><a href="#Secure-MACs-Model" class="headerlink" title="Secure MACs: Model"></a>Secure MACs: Model</h2><p>在定义安全MACs的模型中：</p>
<ul>
<li>Attacker’s power: chosen message attack<br>选择明文攻击: 对于任意的消息 $\mathrm{m_1,m_2,…,m_q}$ ，攻击者能得到其对应的消息验证码 $\mathrm{t}_{\mathrm{i}} \leftarrow \mathrm{S}\left(\mathrm{k}, \mathrm{m}_{\mathrm{i}}\right)$ </li>
<li>Attacker’s goal: existential forgery<br>伪造: 希望能伪造 <strong>新的</strong> message/tag (m,t)。<br>新的，意味着 $(\mathrm{m}, \mathrm{t}) \notin\left\{\left(\mathrm{m}_{1}, \mathrm{t}_{1}\right), \ldots,\left(\mathrm{m}_{\mathrm{q}}, \mathrm{t}_{\mathrm{q}}\right)\right\}$  </li>
</ul>
<p>new valid message/tag pair:</p>
<ul>
<li>attacker cannot produce a valid tag for a new message.<br>意味着不能为新的消息生成有效的tag</li>
<li>given (m,t) attacker cannot even produce (m,t’) for $\mathrm{t’\ne t}$<br>也不能为原消息生成新的tag</li>
</ul>
<h2 id="Secure-MACs-Def"><a href="#Secure-MACs-Def" class="headerlink" title="Secure MACs: Def"></a>Secure MACs: Def</h2><p>在定义的MAC游戏中:</p>
<img src="https://z3.ax1x.com/2021/11/22/Iz0fwn.png" alt="MAC game" style="zoom:33%;" /> 

<p>首先挑战者会随机选择密钥 $\mathrm{k\leftarrow K}$ ，作为MAC的签名算法的密钥。</p>
<p>攻击者向挑战者发起q个询问，每次询问都可以得到该消息对应的消息验证码。</p>
<p>攻击者会生成一对msg/tag pair: (m, t)，如果该pair通过了挑战者的验证算法，并且是一对新的msg/tag pair，挑战者输出：1，否则输出0。</p>
<p>所以secure MACs定义为：攻击者生成new message/tag pair 通过挑战者验证算法的概率为neg.</p>
<p><strong>Def</strong>：I=(S, V) is a secure MAC if for all “efficient” A:<br>$$<br>\mathrm{Adv_{MAC}[A,I]=Pr[Chal. output 1]\quad is “negligible”}<br>$$</p>
<hr>
<p>e.g.1:</p>
<img src="https://z3.ax1x.com/2021/11/22/Iz0Wes.png" alt="e.g.1" style="zoom:33%;" /> 

<p>两个消息具有同样tag的概率为1/2，所以Adv[A, I]=1/2.</p>
<p>e.g.2:</p>
<img src="https://z3.ax1x.com/2021/11/22/Iz02Lj.png" alt="e.g.2" style="zoom:33%;" /> 

<p>同理，tag的长度是5bits，所以两个不同消息有同样tag的概率为1/32.</p>
<h1 id="MACs-Based-on-PRFs"><a href="#MACs-Based-on-PRFs" class="headerlink" title="MACs Based on PRFs"></a>MACs Based on PRFs</h1><p>任何PRF都可以转换为MAC。</p>
<p>对于一个PRF: $\mathrm{F:K\times X\longrightarrow Y}$ </p>
<p>由该PRF定义的MAC $\mathrm{I_F=(S,V)}$ 为：</p>
<img src="https://z3.ax1x.com/2021/11/22/Iz0rJf.png" alt="MACs based on PRFs" style="zoom:33%;" /> 

<ul>
<li>S(k, m) := F(k, m)</li>
<li>V(k, m, t): output ‘yes’ if t = F(k,m) and ‘no’ otherwise.</li>
</ul>
<p>但安全的PRFs不一定可以生成安全的MACs，比如：</p>
<img src="https://z3.ax1x.com/2021/11/22/Iz0sW8.png" alt="a bad example" style="zoom:33%;" /> 

<p>由上式子生成的MACs并不是一个安全的MACs，因为tag的长度太短，攻击者可以为任何消息猜测其tag。</p>
<h2 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h2><p>所以，要保证基于PRFs的MACs的安全性，还需要PRF的输出空间足够大，否则攻击者可以通过猜测攻击成功。</p>
<p><strong><u>Thm</u>:</strong> </p>
<p>If $\mathrm{F:K\times X\rightarrow Y}$ is a secure PRF and 1/|Y| is negligible(i.e. |Y| is large) then $\mathrm{I_F}$ is a secure MAC.</p>
<p>In particular, for every eff. MAC adversary A attacking $\mathrm{I_F}$ there exists an eff. PRF adversary B attacking F s.t.:<br>$$<br>\mathrm{Adv_{MAC}[A,I_F]\le Adv_{PRF}[B, F]+1/|Y|}<br>$$<br>$\mathrm{I_F}$ is secure as long as |Y| is large, say |Y| = $2^{80}$.</p>
<p>对于每一个攻击MAC的攻击者A，都存在攻击对应PRF的攻击者B，满足上述式子。所以如果不等式右边都为neg.，那不等式左边一定为neg.</p>
<h2 id="Truncating-MACs-based-on-PRFs"><a href="#Truncating-MACs-based-on-PRFs" class="headerlink" title="Truncating MACs based on PRFs"></a>Truncating MACs based on PRFs</h2><p>Truncating MACs的定义如下：</p>
<p>Easy lemma: suppose $\mathrm{F:K\times X\rightarrow {0,1}}$ is a secure PRF.</p>
<p>Then so is $\mathrm{F_t(k,m)=F(k,m)[1\dots t]}$ for all $\mathrm{1\le t\le n}$ </p>
<p>基于PRFs的MACs，截断后的MACs，如果tag长度足够长，也是安全的。</p>
<p>if (S,V) is a MAC is based on a secure PRF outputing n‐bit tags the truncated MAC outputing w bits is <strong>secure</strong> as long as <strong>$\mathrm{1/2^w}$  is still negligible</strong> (say w≥64)</p>
<h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h2><p>AES可以看作为：a MAC for 16-byte messages.</p>
<p>所以引入了一个新的问题：how to convert small-MAC into a Big-MAC ?</p>
<p>实践中有两种主流构造方法：</p>
<ul>
<li>CBC-MAC (banking – ANSI X9.9, X9.19, FIPS 186‐3)</li>
<li>HMAC (Internet protocols: SSL, IPsec, SSH, …)</li>
</ul>
<h1 id="Sequential-Constructions"><a href="#Sequential-Constructions" class="headerlink" title="Sequential Constructions"></a>Sequential Constructions</h1><p>本节的主要目标是: given a PRF for short messages (AES) construct a PRF for long messages.</p>
<p>From here on let $\mathrm{X={0,1}^n}$  (e.g. n=128)</p>
<h2 id="1-CBC-MAC"><a href="#1-CBC-MAC" class="headerlink" title="1. CBC-MAC"></a>1. CBC-MAC</h2><p>CBC-MAC 也叫 encrypted CBC-MAC (ECBC)</p>
<p>PRP: $\mathrm{F:K\times X\rightarrow X}$ .</p>
<p>ECBC定义新的PRF $\mathrm{F_{ECBC}:K^2\times X^{\le L}\rightarrow X}$ .</p>
<p>新的PRF的输入为：一对密钥 和 long messages (L: blocks)</p>
<img src="https://z3.ax1x.com/2021/11/22/Iz06SS.png" alt="CBC-MAC" style="zoom:33%;" />

<p>绿色部分就是原生的CBC（使用密钥k），而encrypted表现在对CBC的输出再进行加密操作（使用密钥 $\mathrm{k_1}$ ，得到消息的MAC。</p>
<p>需要注意的是，最后对CBC输出进行加密的密钥是独立于CBC的密钥。</p>
<h2 id="2-NMAC"><a href="#2-NMAC" class="headerlink" title="2. NMAC"></a>2. NMAC</h2><p>NMAC即 nested MAC。</p>
<p>PRF: $\mathrm{F:K\times X\rightarrow K}$ </p>
<p>NMAC定义新的PRF $\mathrm{F_{NMAC}:K^2\times X^{\le L}\rightarrow K}$ .</p>
<p>新的PRF的输入为：一对密钥 和 long messages (L: blocks)</p>
<img src="https://z3.ax1x.com/2021/11/22/Iz0cQg.png" alt="NMAC" style="zoom:33%;" />

<p>绿色部分是层叠(cascade)部分，把本次消息块PRF的输出作为下次消息块PRF运算的密钥，cascade部分的输出为t。</p>
<p>最后对t做padding操作（fixed pad），对于padding后的结果，用新的密钥 $\mathrm{k_1}$ 再做一次PRF运算，得到最终的MAC。</p>
<h2 id="Last-Encryption"><a href="#Last-Encryption" class="headerlink" title="Last Encryption"></a>Last Encryption</h2><p>在ECBC和NMAC中，最后都有加密的步骤。</p>
<p>Why the last encryption step in ECBC-MAC ?</p>
<p><strong>NMAC:</strong></p>
<p>假设NMAC只有cascade部分，即S(k,m)=cascade(k,m)</p>
<p>Then this MAC can be forged with one chosen msg query.</p>
<p><u>Extension Attack:</u> </p>
<p>已知cascade(k, m)，对于任意消息块w，可以轻易得到cascade(k, m||w)的值。</p>
<p>因为cascade(k, m)是作为下一个消息块运算的密钥，所以cascade(k, m||w) = PRF(cascade(k, m), w)。</p>
<p>所以最后的加密步骤是为了阻止extension attack。</p>
<p><strong>ECBC：</strong> </p>
<p>同样，假设ECBC只有raw CBC部分，没有最后加密的步骤，即S(k,m)=rawCBC(k,m).</p>
<p>Then $\mathrm{I_{RAW}=(S,V)}$ is easily broken using a 1-chosen msg attack.</p>
<p><u>1-chosen msg attack:</u></p>
<ol>
<li><p>攻击者随机选择one-block message m.</p>
</li>
<li><p>请求得到m对应的tag t = F(k,m)</p>
</li>
<li><p>攻击者可以伪造2-block message $\mathrm{(m,t\oplus m)}$ 的MAC，其实也就是 t。</p>
<p>$\operatorname{rawCBC}(\mathrm{k},(\mathrm{m}, \mathrm{t} \oplus \mathrm{m}))=\mathrm{F}(\mathrm{k}, \mathrm{F}(\mathrm{k}, \mathrm{m}) \oplus(\mathrm{t} \oplus \mathrm{m}))=\mathrm{F}(\mathrm{k}, \mathrm{t} \oplus(\mathrm{t} \oplus \mathrm{m}))=\mathrm{t}$  </p>
</li>
</ol>
<h2 id="Security-Analysis"><a href="#Security-Analysis" class="headerlink" title="Security Analysis"></a>Security Analysis</h2><p><strong>Theorem</strong>:  For any L &gt; 0,</p>
<p>For every eff. q-query PRF adv. A attacking $\mathrm{F_{ECBC}}$ or $\mathrm{F_{NMAC}}$  , there exists an eff. adversary B s.t.:</p>

$$
\begin{array}{l}\operatorname{Adv}_{\mathrm{PRF}}\left[\mathrm{A}, \mathrm{F}_{\mathrm{ECBC}}\right] \leq \mathrm{Adv}_{\mathrm{PRP}}[\mathrm{B}, \mathrm{F}]+2 \mathrm{q}^{2} /|\mathrm{X}| \\ \operatorname{Adv}_{\mathrm{PRF}}\left[\mathrm{A}, \mathrm{F}_{\mathrm{NMAC}}\right] \leq \mathrm{q} \cdot \mathrm{L} \cdot \mathrm{Adv}_{\mathrm{PRF}}[\mathrm{B}, \mathrm{F}]+\mathrm{q}^{2} / 2|\mathrm{~K}|\end{array}
$$


<p>CBC‐MAC is secure as long as q &lt;&lt; $|X|^{1/2}$ </p>
<p> NMAC is secure as long as q &lt;&lt; $|K|^{1/2}$</p>
<p>(q &lt;&lt; $2^{64}$ for AES-­128)</p>
<hr>
<p>为了简化讨论，考虑不等式： $\operatorname{Adv}_{\mathrm{PRF}}\left[\mathrm{A}, \mathrm{F}_{\mathrm{ECBC}}\right] \leq \mathrm{Adv}_{\mathrm{PRP}}[\mathrm{B}, \mathrm{F}]+ \mathrm{q}^{2} /|\mathrm{X}|$  </p>
<p>q = #messages MAC-ed with k</p>
<p>如果我们想得到 $\operatorname{Adv}_{\mathrm{PRF}}\left[\mathrm{A}, \mathrm{F}_{\mathrm{ECBC}}\right] \leq 1 / 2^{32}$ 的结果，必须满足： $\mathrm{q^{2} /|X|<1 / 2^{32} }$   </p>
<ul>
<li>对于基于AES的$\mathrm{F_{ECBC}}$：|X|=$2^{128}$ ，q必须满足 q &lt; $2^{48}$ 。所以在对 $2^{48}$ 个messages进行MAC运算后，必须更换密钥。</li>
<li>对于基于3DES的$\mathrm{F_{ECBC}}$: |X|= $2^{64}$ ，q必须满足 q &lt; $2^{16}$ .</li>
</ul>
<h3 id="Extension-Property"><a href="#Extension-Property" class="headerlink" title="Extension Property"></a>Extension Property</h3><p>如果构造出的PRFs(ECBC 和 NMAC)的底层PRF是一个PRP（比如AES），那么构造出的PRFs都有可扩展性：</p>

$$
\forall \mathrm{x}, \mathrm{y}, \mathrm{w}: \mathrm{F}_{\mathrm{BIG}}(\mathrm{k}, \mathrm{x})=\mathrm{F}_{\mathrm{BIG}}(\mathrm{k}, \mathrm{y}) \quad \Rightarrow \quad \mathrm{F}_{\mathrm{BIG}}(\mathrm{k}, \mathbf{x||w}  )=\mathrm{F}_{\mathrm{BIG}}(\mathrm{k}, \mathbf { y||w })
$$


<p>因为底层是一个PRP，所以$F(k_1,\cdot)$ 是一个one to one function，输出相同，对应的输入也是相同的，因此rawCBC或者NCBC的cascade部分的输出是相同的。</p>
<h3 id="The-security-bounds-are-tight-an-attack"><a href="#The-security-bounds-are-tight-an-attack" class="headerlink" title="The security bounds are tight: an attack"></a>The security bounds are tight: an attack</h3><p>上述定理的安全约束是紧的，所以当q不满足约束时，MAC就不安全了。</p>
<blockquote>
<p>After signing $|X|^{1/2}$ messages with ECBC-MAC or $|K|^{1/2}$ messages with NMAC,</p>
<p>the MACs become insecure.</p>
</blockquote>
<p>对于满足可扩展性的PRF $\mathrm{F}_{\mathrm{BIG}}: \mathrm{K} \times \mathrm{X} \longrightarrow \mathrm{Y}$ ， 可以构造出一般攻击：</p>
<ol>
<li>随机选取 $|Y|^{1/2}$ 个不同的消息，请求询问得到对应的tag: $(m_i,t_i)$ </li>
<li>根据生日悖论，可以找到碰撞：$t_u=t_v$ </li>
<li>选择w，攻击者构造消息 $m_u||w$，请求询问其tag： $\mathrm{t}:=\mathrm{F}_{\mathrm{BIG}}\left(\mathrm{k}, \mathrm{m}_{\mathrm{u}} \| \mathrm{w}\right)$  </li>
<li>此时，攻击者可以成功伪造pair： $\mathrm{(m_{v} || w, t})$<br>根据可扩展性， $\mathrm{t}=\mathrm{F}_{\mathrm{BIG}}\left(\mathrm{k}, \mathrm{m}_{\mathrm{v}} \| \mathrm{w}\right)$  </li>
</ol>
<h2 id="Rand-Construction"><a href="#Rand-Construction" class="headerlink" title="Rand. Construction"></a>Rand. Construction</h2><p>另一种引入随机性的构造，可以具备更好的安全性。</p>
<img src="https://z3.ax1x.com/2021/11/22/Iz0gyQ.png" alt="a rand. construction" style="zoom:33%;" />

<p>Let $\mathrm{F:K\times X\rightarrow X}$ be a PRF.</p>
<p>将rawCBC的结果和随机值，构造为2-block，再次进行运算。</p>
<p>最终的结果：MAC with tags in $X^2$  </p>
<p><strong>Security:</strong> $\mathrm{A d v_{M A C}\left[A, I_{R C B C}\right] \leq A d v_{P R P}[B, F] \cdot\left(1+2 q^{2} /|X|\right) }$ </p>
<p>在这种构造情况下，3DES can sign q = $2^{32}$  msgs with one key.</p>
<h2 id="Comparison"><a href="#Comparison" class="headerlink" title="Comparison"></a>Comparison</h2><p>ECBC‐MAC 的构造方式常常用来构造基于AES的MAC</p>
<ul>
<li>比如CCM encryption mode (used in 802.11i)</li>
<li>NIST standard called CMAC</li>
</ul>
<p>而NMAC的构造方式一般不使用AES或3DES</p>
<ul>
<li>主要的原因是：在NMAC中，对每个block的计算都需要更换AES密钥，也就需要重复进行AES密钥扩展。</li>
<li>但NMAC是HMAC的基础。</li>
</ul>
<h1 id="MAC-Padding"><a href="#MAC-Padding" class="headerlink" title="MAC Padding"></a>MAC Padding</h1><p>如果msg的长度不是block-size的整数倍，就需要对msg进行padding操作。</p>
<h2 id="CBC-MAC-padding"><a href="#CBC-MAC-padding" class="headerlink" title="CBC MAC padding"></a>CBC MAC padding</h2><p>如果只是简单对msg进行0填充，那将会得到一个不安全的MAC，因为pad(m) = pad(m||0)，所以对于给定msg m 的tag，攻击者可以轻易得到m||0的tag。</p>
<p>因此，为了安全性的考虑，padding操作应该是可逆的，所以如果两个消息是不同的，那么进行padding操作后的消息也应该是不同的，即： $\mathrm{m}_{0} \neq \mathrm{m}_{1} \quad \Rightarrow \quad \operatorname{pad}\left(\mathrm{m}_{0}\right) \neq \operatorname{pad}\left(\mathrm{m}_{1}\right)$     ，否则攻击者就可以利用该特性进行伪造。</p>
<p><u>ISO：</u> pad with ‘1000…00’.  Add new dummy block if needed. </p>
<p>(The ‘1’ indicates beginning of pad)</p>
<ul>
<li><p>对于msg长度不是block-size整数倍的情况，用’100..0’字符串进行填充：</p>
<img src="https://z3.ax1x.com/2021/11/23/opUGbn.png" alt="padding" style="zoom:33%;" />
</li>
<li><p>对于msg长度是block-size整数倍的情况，需要增加一个dummy block:</p>
<img src="https://z3.ax1x.com/2021/11/23/opU8Ds.png" alt="padding" style="zoom:33%;" />
如果不增加dummy block，padding function就不可逆了。

</li>
</ul>
<h2 id="CMAC-NIST-standard"><a href="#CMAC-NIST-standard" class="headerlink" title="CMAC (NIST standard)"></a>CMAC (NIST standard)</h2><p>介绍padding后，这里介绍一种CBC-MAC的变体，也是NIST的标准。</p>
<img src="https://z3.ax1x.com/2021/11/23/opUM8S.png" alt="CMAC" style="zoom:33%;" />

<p>key $=(k,k_1,k_2)$ </p>
<p>在这种构造方式下，没有最后一步的加密步骤，padding时也不需要增加dummy block。</p>
<ul>
<li>No final encryption step (extension attack thwarted by last keyed xor)<br>因为最后一步使用密钥$k_2$异或，所以不知道函数F(k, ·)的输入，也就不能进行extension attack。</li>
<li>No dummy block (ambiguity resolved by use of $k_1$ or $k_2$)<br>最后一步通过两个不同密钥的使用来解决歧议情况。</li>
</ul>
<h1 id="Parallel-Constructions"><a href="#Parallel-Constructions" class="headerlink" title="Parallel Constructions"></a>Parallel Constructions</h1><p>ECBC和NMAC都是时序性(sequential)，本节将通过a small PRF构造a parallel MAC.</p>
<h2 id="3-PMAC-parallel-MAC"><a href="#3-PMAC-parallel-MAC" class="headerlink" title="3. PMAC: parallel MAC"></a>3. PMAC: parallel MAC</h2><p>Let $\mathrm{F:K\times X\rightarrow X}$ be a PRF</p>
<p>定义新的PRF：$\mathrm{F_{PMAC}:K^2\times X^{\le L}\rightarrow X}$ , key $=(k,k_1)$ </p>
<img src="https://z3.ax1x.com/2021/11/23/opU3uj.png" alt="PMAC" style="zoom:30%;" />

<p>P(k, i): an easy to compute function</p>
<p>padding: similar to CMAC, but no need for dummy block</p>
<p>首先用P(k, i)对msg的每一块执行异或操作，这一步可以同步进行。异或的结果再作为$F(k_1,\cdot)$ 的输入，最后把所有$F(k_1,\cdot)$的输出异或在一起，作为最后一层$F(k_1,\cdot)$ 的输入，最终得到tag.</p>
<p>几点说明：</p>
<ol>
<li>m[i] 与 P(k, i)异或的必要性：如果不进行这一步，交换消息中的不同块，也可以得到相同的MAC，即block swapping attack，PMAC变得不再安全。所以P(k, i)的作用是保存消息的顺序。</li>
<li>最后一块不需要再通过$F(k_1,\cdot)$，是技术原因。</li>
<li>因为P(k, i)增加了block的块数/顺序信息，所以不需要增加dummy block。</li>
</ol>
<h3 id="PMAC-Analysis"><a href="#PMAC-Analysis" class="headerlink" title="PMAC: Analysis"></a>PMAC: Analysis</h3><p><u>PMAC Theorem:</u> For any L &gt; 0, </p>
<p>If F is a secure PRF over (K,X,X) then $F_{PMAC}$ is a secure PRF over $\mathrm{(K,X^{\le L}, X)}$ .</p>
<p>For every eff. q-query PRF adv. A attacking $F_{PMAC}$, there exists an eff. PRF adversary B s.t.:<br>$$<br>\mathrm{Adv_{PRF}[A,F_{PMAC}]\le Adv_{PRF}[B,F]+2q^2L^2/|X|}<br>$$<br><strong>PMAC is secure as long as qL &lt;&lt; $|X|^{1/2}$ .</strong> </p>
<h3 id="PMAC-is-incremental"><a href="#PMAC-is-incremental" class="headerlink" title="PMAC is incremental"></a>PMAC is incremental</h3><p>PMAC是可以增量计算的。</p>
<img src="https://z3.ax1x.com/2021/11/23/opUYEq.png" alt="PMAC is incremental" style="zoom:55%;" />

<p>如果m[1]变成m’[1]后，可以快速更新tag =  $\mathrm{F}^{-1}\left(\mathrm{k}_{1}, \mathrm{tag}\right) \oplus \mathrm{F}\left(\mathrm{k}_{1}, \mathrm{m}[1] \oplus \mathrm{P}(\mathrm{k}, 1)\right) \oplus \mathrm{F}\left(\mathrm{k}_{1}, \mathrm{m}^{\prime}[1] \oplus \mathrm{P}(\mathrm{k}, 1)\right)$     </p>
<h2 id="One-Time-MAC"><a href="#One-Time-MAC" class="headerlink" title="One Time MAC"></a>One Time MAC</h2><p>One-time MAC 也是One-time pad的类比，密钥只应用于一条消息。</p>
<p>定义的MAC游戏如下，攻击者只能得到一条消息对应的tag：</p>
<img src="https://z3.ax1x.com/2021/11/23/opUlvQ.png" alt="One-time MAC" style="zoom:33%;" />

<p>Def: I=(S,V) is a <u>secure MAC</u> if for all “efficient” A:<br>$$<br>\operatorname{Adv}_{1 \mathrm{MAC}}[\mathrm{A}, \mathrm{l}]=\operatorname{Pr}[\text { Chal. outputs 1] } \quad \text { is “negligible.” }<br>$$</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>One-time MAC可以抵抗所有的攻击者，具有unconditional security（perfect security）。此外，One-time MAC相对于基于PRF的MAC，具有更快的运算速度。</p>
<blockquote>
<p>One-time MAC can be secure against <strong>all</strong> adversaries and faster than PRF-based MACs.</p>
</blockquote>
<p>$\mathrm{q}$:  一个大素数（比如q = $2^{128}$ +51)</p>
<p>$\mathrm{\text {key}=(a, b) \in{1, \ldots, q}^{2}}$ : 两个随机数 </p>
<p>$\mathrm{\mathrm{msg}=(\mathrm{m}[1], \ldots, \mathrm{m}[\mathrm{L}])}$  ：每一块都看作是是128 bit的整数</p>
<p><strong>MAC</strong> ：计算以msg作为系数的多项式<br>$$<br>\begin{array}{c}S(\text { key, msg} )=\mathrm{P_{m s g}(a)+b \quad(\bmod q)} \ \text { where } \mathrm{P_{m s g}(x)=x^{L+1}+m[L] \cdot x^{L}+\ldots+m[1] \cdot x \quad \text { is a poly. of } \operatorname{deg} L+1 }\end{array}<br>$$<br>We show: given S( key, $\mathrm{msg_1}$ ) adv. has no info about S( key, $\mathrm{msg_2}$ )</p>
<p>在One- time MAC中，S(key, $\mathrm{msg_1}$ )不会透露任何关于S(key, $\mathrm{msg_2}$)的信息，所以One-time key是绝对安全的，但和ont-time pad 类似，如果将相同密钥作用于不同的消息上，two-time MAC则是不安全的。</p>
<h3 id="Unconditional-Security"><a href="#Unconditional-Security" class="headerlink" title="Unconditional Security"></a>Unconditional Security</h3><p>在上面的例子中：given S( key, $\mathrm{msg_1}$ ) adv. has no info about S( key, $\mathrm{msg_2}$ )，现在我们来证明one-time MAC的unconditional security.</p>
<p><u><strong>Thm:</strong></u> the ont-time MAC in the example satisfies: (L = msg-len, q is the prime)<br>$$<br>\mathrm{\forall m_{1} \neq m_{2}, t_{1}, t_{2}: \quad P r_{a, b}\left[s\left((a, b), m_{1}\right)=t_{1} \mid s\left((a, b), m_{2}\right)=t_{2}\right] \leq L / q}<br>$$<br><strong>Proof:</strong> $\forall \mathrm{m_1\ne m_2,t_1,t_2}:$ </p>
<ol>
<li> $\mathrm{\operatorname{Pr}_{a, b}\left[s\left((a, b), m_{2}\right)=t_{2}\right]=\operatorname{Pr}_{a, b}\left[P_{m_{2}}(a)+b=t_{2}\right]=1 / q}$  
对于任意的$m_2$，多项式计算出的结果等于$t_2$ 的概率为1/q。</li>
<li> $\mathrm{\operatorname{Pr}_{\mathrm{a}, \mathrm{b}}\left[s\left((\mathrm{a}, \mathrm{b}), \mathrm{m}_{1}\right)=\mathrm{t}_{1} \text { and } s\left((\mathrm{a}, \mathrm{b}), \mathrm{m}_{2}\right)=\mathrm{t}_{2}\right]}$   
 $=\operatorname{Pr}_{\mathrm{a}, \mathrm{b}}\left[\mathrm{P}_{\mathrm{m}_{1}}(\mathrm{a})-\mathrm{P}_{\mathrm{m}_{2}}(\mathrm{a})=\mathrm{t}_{1}-\mathrm{t}_{2} \text { and } \mathrm{P}_{\mathrm{m}_{2}}(\mathrm{a})+\mathrm{b}=\mathrm{t}_{2}\right] \leq \mathrm{L} / \mathrm{q}^{2}$  
<ul>
<li>概率第二个条件，任意的$m_2$，多项式计算出的结果等于$t_2$ 的概率为1/q。</li>
<li>概率第一个条件，两式相减后，得到一个deg L的多项式，该多项式值为 $\mathrm{t_1-t_2}$ 的概率为1/q。但这是一个度为L的多项式，所以最多可能有L个根。所以第一个条件的概率是&lt;=L/q</li>
</ul>
</li>
<li>最后使用条件概率</li>
</ol>
<p>该定理表明，只得到一对有效的 $(m_2,t_2)$，攻击者构造出有效 $(m_1,t_1)$ 的概率 $\le \mathrm{L/q}$ .</p>
<h3 id="Many-time-MAC-Cater-Wegman-MAC"><a href="#Many-time-MAC-Cater-Wegman-MAC" class="headerlink" title="Many-time MAC: Cater-Wegman MAC"></a>Many-time MAC: Cater-Wegman MAC</h3><p>(S,V): 是一个安全的one-time MAC over $(K_I,M,{0,1} ^n)$.</p>
<p>$F:K_F\times {0,1}^n \rightarrow {0,1}^n$ 是 安全的PRF.</p>
<p><strong>Cater-Wegman MAC:</strong><br>$$<br>\mathrm{C W\left(\left(k_{1}, k_{2}\right), m\right)=\left(r, F\left(k_{1}, r\right) \oplus S\left(k_{2}, m\right)\right)} \quad \text{ for random r }\leftarrow {0,1}^n<br>$$<br>CW MAC首先选取了一个随机值 r，然后用PRF对随机值加密,，得到 $\mathrm{F(k_1,r)}$ 。再用one-time MAC作用于消息，得到的结果与PRF的结果异或。</p>
<p>这也是一个randomized MAC，当计算不同消息验证码时，密钥可以重复使用，但每次都选取不同的随机值。PRF计算较慢，但作用在一个较短的随机串上，one-time MAC计算更快。作用在较长的消息串上，Carter-Wegman MAC更适合。</p>
<img src="https://z3.ax1x.com/2021/11/23/opUQgg.png" alt="CW MAC" style="zoom:33%;" />

<p><u><strong>Thm</strong></u> : If (S,V) is a secure <strong>one-time MAC</strong> and F is a secure PRF, then CW is a secure MAC outputting tags in ${0,1}^{2n}$  .</p>
<h1 id="Further-Reading"><a href="#Further-Reading" class="headerlink" title="Further Reading"></a>Further Reading</h1><ul>
<li>[basis of CBC MACs] J. Black, P. Rogaway: CBC MACs for Arbitrary-­Length Messages: The Three­Key Constructions. J. Cryptology 18(2): 111‐131 (2005)</li>
<li>K. Pietrzak: A Tight Bound for EMAC. ICALP (2) 2006: 168-179</li>
<li>[PMAC] J. Black, P. Rogaway: A Block-­‐Cipher Mode of Operation for Parallelizable Message Authentication. EUROCRYPT 2002: 384-­‐397</li>
<li>[security of NMAC] M. Bellare: New Proofs for NMAC and HMAC: Security Without Collision­Resistance. CRYPTO 2006: 602-­‐619</li>
<li>Y. Dodis, K. Pietrzak, P. Puniya: A New Mode of Operation for Block Ciphers and Length-Preserving MACs. EUROCRYPT 2008: 198‐219</li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>「Cryptography-Boneh」:Integrity</p><p><a href="https://f7ed.com/2021/11/22/stanford-integrity1/">https://f7ed.com/2021/11/22/stanford-integrity1/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>f7ed</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2021-11-22</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-12-28</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a><a class="icons" rel="noopener" target="_blank" title="Share Alike" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><i class="icon fab fa-creative-commons-sa"></i></a><a class="" rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></p></div></div></div></div></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/%E5%85%AC%E5%BC%80%E8%AF%BE/">公开课, </a><a class="link-muted" rel="tag" href="/tags/Cryptography/">Cryptography, </a><a class="link-muted" rel="tag" href="/tags/PRF/">PRF, </a><a class="link-muted" rel="tag" href="/tags/Integrity/">Integrity, </a><a class="link-muted" rel="tag" href="/tags/MAC/">MAC </a></div></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/img/qrcode_wechat.jpg" alt="Wechat"></span></a><a class="button donate" href="https://www.buymeacoffee.com/f7ed" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/img/qrcode_alipay.jpg" alt="Alipay"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/12/23/Mersenne-Prime/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">「Math」：Mersenne Prime</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/11/08/2021-11-paper-reading/"><span class="level-item">「Paper Reading」：未整理版论文笔记</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "384fe0291ebe7ee4efa22874042c8993",
            repo: "f7ed.github.io",
            owner: "f7ed",
            clientID: "ec59f5258ac0ec443907",
            clientSecret: "f092b308c3e1b46327481c3547ee0dd7fc1bda10",
            admin: ["f7ed"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "en",
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/profile.png" alt="f7ed"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">f7ed</p><p class="is-size-6 is-block">热爱可抵漫长岁月。</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Shanghai, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">71</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">15</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">139</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="mailto:f7edliu@outlook.com" target="_blank" rel="noopener">Email me</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/f7ed"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Message-Auth-Codes"><span class="level-left"><span class="level-item">1</span><span class="level-item">Message Auth. Codes</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Secure-MACs-Model"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Secure MACs: Model</span></span></a></li><li><a class="level is-mobile" href="#Secure-MACs-Def"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">Secure MACs: Def</span></span></a></li></ul></li><li><a class="level is-mobile" href="#MACs-Based-on-PRFs"><span class="level-left"><span class="level-item">2</span><span class="level-item">MACs Based on PRFs</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Security"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">Security</span></span></a></li><li><a class="level is-mobile" href="#Truncating-MACs-based-on-PRFs"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Truncating MACs based on PRFs</span></span></a></li><li><a class="level is-mobile" href="#Examples"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">Examples</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Sequential-Constructions"><span class="level-left"><span class="level-item">3</span><span class="level-item">Sequential Constructions</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-CBC-MAC"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">1. CBC-MAC</span></span></a></li><li><a class="level is-mobile" href="#2-NMAC"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">2. NMAC</span></span></a></li><li><a class="level is-mobile" href="#Last-Encryption"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">Last Encryption</span></span></a></li><li><a class="level is-mobile" href="#Security-Analysis"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">Security Analysis</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Extension-Property"><span class="level-left"><span class="level-item">3.4.1</span><span class="level-item">Extension Property</span></span></a></li><li><a class="level is-mobile" href="#The-security-bounds-are-tight-an-attack"><span class="level-left"><span class="level-item">3.4.2</span><span class="level-item">The security bounds are tight: an attack</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Rand-Construction"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">Rand. Construction</span></span></a></li><li><a class="level is-mobile" href="#Comparison"><span class="level-left"><span class="level-item">3.6</span><span class="level-item">Comparison</span></span></a></li></ul></li><li><a class="level is-mobile" href="#MAC-Padding"><span class="level-left"><span class="level-item">4</span><span class="level-item">MAC Padding</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#CBC-MAC-padding"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">CBC MAC padding</span></span></a></li><li><a class="level is-mobile" href="#CMAC-NIST-standard"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">CMAC (NIST standard)</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Parallel-Constructions"><span class="level-left"><span class="level-item">5</span><span class="level-item">Parallel Constructions</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-PMAC-parallel-MAC"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">3. PMAC: parallel MAC</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#PMAC-Analysis"><span class="level-left"><span class="level-item">5.1.1</span><span class="level-item">PMAC: Analysis</span></span></a></li><li><a class="level is-mobile" href="#PMAC-is-incremental"><span class="level-left"><span class="level-item">5.1.2</span><span class="level-item">PMAC is incremental</span></span></a></li></ul></li><li><a class="level is-mobile" href="#One-Time-MAC"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">One Time MAC</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Example"><span class="level-left"><span class="level-item">5.2.1</span><span class="level-item">Example</span></span></a></li><li><a class="level is-mobile" href="#Unconditional-Security"><span class="level-left"><span class="level-item">5.2.2</span><span class="level-item">Unconditional Security</span></span></a></li><li><a class="level is-mobile" href="#Many-time-MAC-Cater-Wegman-MAC"><span class="level-left"><span class="level-item">5.2.3</span><span class="level-item">Many-time MAC: Cater-Wegman MAC</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#Further-Reading"><span class="level-left"><span class="level-item">6</span><span class="level-item">Further Reading</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/f1ed_logo.png" alt="fred&#039;s blog" height="28"></a><p class="is-size-7"><span>&copy; 2025 f7ed</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent " target="_blank" rel="noopener" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="f7ed&#039;s GitHub" href="https://github.com/f7ed"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script>
      var sc_project=12961083;
      var sc_invisible=1;
      var sc_security="ad3fb575";
      var sc_https=1;
      var sc_remove_link=1;</script><script src="https://www.statcounter.com/counter/counter.js" async></script><noscript><div class="statcounter"><img class="statcounter" src="https://c.statcounter.com/12961083/0/ad3fb575/1/" alt="real time web analytics"></div></noscript><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>