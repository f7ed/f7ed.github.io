<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>「Cryptography-ZKP」: Lec6 Poly-commit based on Pairing and Discret-log - fred&#039;s blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="fred&#039;s blog"><meta name="msapplication-TileImage" content="/img/heart.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="fred&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="In this series, I will learn Zero Knowledge Proofs (ZKP) on this MOOC, lectured by Dan Boneh, Shafi Goldwasser, Dawn Song, Justin Thaler and Yupeng Zhang.  Any corrections and advice are welcom"><meta property="og:type" content="blog"><meta property="og:title" content="「Cryptography-ZKP」: Lec6 Poly-commit based on Pairing and Discret-log"><meta property="og:url" content="https://f7ed.com/2023/07/26/zkp-lec6/"><meta property="og:site_name" content="fred&#039;s blog"><meta property="og:description" content="In this series, I will learn Zero Knowledge Proofs (ZKP) on this MOOC, lectured by Dan Boneh, Shafi Goldwasser, Dawn Song, Justin Thaler and Yupeng Zhang.  Any corrections and advice are welcom"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://f7ed.com/gallery/covers/zkp-lec6-banner.png"><meta property="article:published_time" content="2023-07-25T16:00:00.000Z"><meta property="article:modified_time" content="2023-07-27T07:53:23.274Z"><meta property="article:author" content="f7ed"><meta property="article:tag" content="Cryptography"><meta property="article:tag" content="ZKP"><meta property="article:tag" content="Poly-commit"><meta property="article:tag" content="Bulletproofs"><meta property="article:tag" content="KZG"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/gallery/covers/zkp-lec6-banner.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://f7ed.com/2023/07/26/zkp-lec6/"},"headline":"「Cryptography-ZKP」: Lec6 Poly-commit based on Pairing and Discret-log","image":["https://f7ed.com/gallery/covers/zkp-lec6-banner.png"],"datePublished":"2023-07-25T16:00:00.000Z","dateModified":"2023-07-27T07:53:23.274Z","author":{"@type":"Person","name":"f7ed"},"publisher":{"@type":"Organization","name":"fred's blog","logo":{"@type":"ImageObject","url":"https://f7ed.com/img/f1ed_logo.png"}},"description":"In this series, I will learn Zero Knowledge Proofs (ZKP) on this MOOC, lectured by Dan Boneh, Shafi Goldwasser, Dawn Song, Justin Thaler and Yupeng Zhang.  Any corrections and advice are welcom"}</script><link rel="canonical" href="https://f7ed.com/2023/07/26/zkp-lec6/"><link rel="icon" href="/img/heart.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-M5KG3CQTSF" async></script><script><!-- hexo-inject:begin --><!-- hexo-inject:end -->window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-M5KG3CQTSF');</script><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="fred's blog" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/f1ed_logo.png" alt="fred&#039;s blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/liu">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/f7ed"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><i class="fas fa-bars"></i>「Cryptography-ZKP」: Lec6 Poly-commit based on Pairing and Discret-log</h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="2023-07-25T16:00:00.000Z" title="2023-07-25T16:00:00.000Z">2023-07-26</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="2023-07-27T07:53:23.274Z" title="2023-07-27T07:53:23.274Z">2023-07-27</time></span><span class="level-item"><i class="far fa-folder-open has-text-grey"></i> <a class="link-muted" href="/categories/Cryptography-ZKP/">Cryptography-ZKP</a></span><span class="level-item"><i class="far fa-clock"></i> 38 minutes read (About 5661 words)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><div class="content"><article class="message message-immersive is-info">
<!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="message-body">
<i class="fas fa-info-circle mr-2"></i>
    In this <a href="/categories/Cryptography-ZKP">series</a>, I will learn <strong>Zero Knowledge Proofs (ZKP)</strong> on this <a target="_blank" rel="noopener" href="https://zk-learning.org/">MOOC</a>, lectured by Dan Boneh, Shafi Goldwasser, Dawn Song, Justin Thaler and <strong>Yupeng Zhang</strong>. 
<br>Any corrections and advice are welcome. ^ - ^
</div>
</article>



<p><strong>Topics:</strong></p>
<ul>
<li><strong>KZG poly-commit based on bilinear pairing</strong><ul>
<li>KZG scheme</li>
<li>Powers-of-tau Ceremony</li>
<li>Security Analysis</li>
<li>Knowledge of exponent assumption</li>
<li>Variants: multivariate; ZK; batch openings</li>
</ul>
</li>
<li><strong>Bulletproofs poly-commit based on discrete logarithm</strong></li>
</ul>
<span id="more"></span>



<p>Before proceeding to today’s topic, let’s recall the common recipe for building an efficient SNARK.</p>
<img src="https://s1.ax1x.com/2023/07/25/pCXSG3q.png" alt="Paradigm of building SNARKs" style="zoom:33%;" />

<p>The common way of building SNARK is to combine a poly-IOP with a functional commitment scheme.</p>
<p>Lecture 4 uses Plonk (poly-IOP) combined with KZG (a univariate polynomial commitment) to build SNARK for general circuits.</p>
<img src="https://s1.ax1x.com/2023/07/25/pCXS8Cn.png" alt="Plonk poly-IOP combined with KZG" style="zoom:33%;" />

<p>Lecture 3 uses Sumcheck protocol combined with a multivariate polynomial commitment to build SNARK.</p>
<img src="https://s1.ax1x.com/2023/07/25/pCXSQEQ.png" alt="Sumcheck protocol combined with multivariate poly-commitment" style="zoom:33%;" />

<p>In this lecture, we are going to introduce polynomial commitments based on bilinear pairing and discrete log.</p>
<p>When <strong>building polynomial commitment schemes</strong>, we first choose a family of polynomial $\mathcal{F}$, then prover commits to a function $f(x)\in \mathcal{F}$.</p>
<p>Verifier receives $\text{com}_f$ as the commitment, then  verifier is able to query $f$ at point $u$.</p>
<p>Finally, prover sends the evaluation $v$ and the proof $\pi$ that $f(u)=v$ and $f\in \mathcal{F}$, and verifier accepts if proof is valid.</p>
<p>The above procedure is depicted as follows.</p>
<img src="https://s1.ax1x.com/2023/07/25/pCXS14s.png" alt="Poly-commitment Scheme" style="zoom:33%;" />

<p>For ease of use, we give a formal definition for polynomial commitment schemes (PCS).</p>
<p>It consists of four algorithms as follows.</p>
<ul>
<li>$\text{keygen}(\lambda, \mathcal{F})\rightarrow gp$<br>In setup, this algorithm takes the family as inputs and outputs the global parameters used in the commitment and proof.</li>
<li>$\text{commit}(gp,f)\rightarrow \text{com}_f$<br>Prover calls this algorithm to commit to a function.</li>
<li>$\text{eval}(gp,f,u)\rightarrow v,\pi$<br>Prover calls this algorithm to compute the evaluation at the point $u$ and the corresponding proof.</li>
<li>$\text{verify}(gp,\text{com}_f,u,v,\pi)\rightarrow \text{accept or reject}$<br>Verifier calls this algorithm to check the validity of the proof and accept the answer if valid.</li>
</ul>
<p>It is complete if an honest prover can convince the verifier to accept the answer.</p>
<p>It is sound if a verifier can catch a lying prover with high probability.</p>
<p>We compare the soundness and knowledge soundness in Lecture 3. To put it simply, <strong>soundness</strong> establishes the <u>existence</u> of the witness while <strong>knowledge soundness</strong> establishes that the prover <u>necessarily knows the witness</u>. As a result, knowledge soundness is stronger.</p>
<p>We give a formal definition of knowledge soundness.</p>
 <article class="message is-info"> <div class="message-header"> 

<p><strong>Knowledge Sound:</strong></p>
 </div> <div class="message-body"> 

<p>For every poly. time adversary $A(A_0, A_1)$ such that </p>

$$
\text{keygen}(\lambda,\mathcal{F})\rightarrow gp, A_0(gp)\rightarrow \text{com}_f, A_1(gp, u)\rightarrow v, \pi: \\ \operatorname{Pr}[V(vp, x,\pi)=\text{accept}]=1
$$



<p>there is an efficient <strong>extractor</strong> $E$ (that uses $A$) such that </p>

$$
\text{keygen}(\lambda,\mathcal{F})\rightarrow gp, A_0(gp)\rightarrow \text{com}_f, E(gp, \text{com}_f)\rightarrow f:\\ \operatorname{Pr}[f(u)=v \text{ and } f(x)\in \mathcal{F}]> 1-\epsilon 
$$



<p>where $\epsilon$  is negligible.</p>
 </div> </article> 

<h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>Let’s quickly go through the basic conceptions in number theory, which is widely used in the following sections.</p>
<p>I refer readers to  This Blog for a detailed description.</p>
 <article class="message is-info"> <div class="message-header"> 

<p><strong>Group:</strong> A set $\mathbb{G}$ and an operation $*$</p>
 </div> <div class="message-body"> 

<ol>
<li>Closure: For all $a,b\in \mathbb{G}$, $a* b \in \mathbb{G}$</li>
<li>Associativity: For all $a,b,c\in \mathbb{G}$, $(a*b)*c =a*(b*c)$ </li>
<li>Identity: There exists a unique element $e\in \mathbb{G}$ s.t. for every $a\in \mathbb{G}$, $e*a=a*e=a$.</li>
<li>Inverse: For each $a\in \mathbb{G}$, there exists $b\in \mathbb{G}$ s.t. $a*b=b*a=e$. </li>
</ol>
 </div> </article> 

A simple example is the group that contains integers $\{\dots, -2,-1,0,1,2,\dots\}$ under addition operation $+$.

The common Groups considered in Cryptography are the group that contains positive integers mod prime $p:\{1,2,\dots, p-1\}$ under multiplication operation $\times$ and the groups defined by elliptic curves.

 <article class="message is-info"> <div class="message-header"> 

<p><strong>Generator of a group:</strong></p>
 </div> <div class="message-body"> 

<p>An element $g$ that generates all elements in the group by taking all powers of $g$.</p>
 </div> </article> 

<p>For example, $3$ is a generator of the group $\mathbb{Z}_7^*={1,2,3,4,5,6}$.</p>
<p>We can write every group element in the power of $3$.</p>
<p>$3^1=3;3^2=2;3^3=6;3^4=4;3^5=5;3^6=1 \mod 7$</p>
<h2 id="Discrete-log"><a href="#Discrete-log" class="headerlink" title="Discrete-log"></a>Discrete-log</h2>A group $\mathbb{G}$ has an alternative representation as the powers of the generator $g:\{g,g^2, g^3,\dots,g^{p-1}\}$.

 <article class="message is-info"> <div class="message-header"> 

<p><strong>Discrete logarithm problem:</strong></p>
 </div> <div class="message-body"> 

<p>Given $y\in \mathbb{G}$, find $x$ such that $g^x=y$.</p>
 </div> </article> 

<p>The quantum computer can actually solve the discrete logarithm problem in polynomial time.</p>
 <article class="message is-info"> <div class="message-header"> 

<p><strong>Discrete logarithm assumption:</strong></p>
 </div> <div class="message-body"> 

<p>Discrete-log problem is computationally hard.</p>
 </div> </article> 

<p>Note that the DL assumption <u>does not hold in all groups</u> but it is believed to hold in certain groups.</p>
 <article class="message is-info"> <div class="message-header"> 

<p><strong>Computational Diffie-Hellman assumption:</strong></p>
 </div> <div class="message-body"> 

<p>Given $\mathbb{G},g,g^x,g^y$, cannot compute $g^{xy}$.</p>
 </div> </article> 

<p>It is worth noting that <u>a stronger assumption means the underlying problem is easier.</u></p>
<p>Hence, the CDH assumption is a stronger assumption than the DL assumption since the CDH problem is reducible to the DL problem.</p>
<h2 id="Bilinear-Pairing"><a href="#Bilinear-Pairing" class="headerlink" title="Bilinear Pairing"></a>Bilinear Pairing</h2><p>The bilinear pairing is defined over $(p,\mathbb{G},g,\mathbb{G}_T,e)$.</p>
<ul>
<li>$\mathbb{G}$: the base group of order $p$, a multiplicative cyclic group</li>
<li>$\mathbb{G}_T$: the target group of order $p$, a multiplicative cyclic group</li>
<li>$g$: the generator of $\mathbb{G}$</li>
<li>$e:\mathbb{G}\times \mathbb{G} \rightarrow \mathbb{G}_T$, the pairing operation</li>
</ul>
<p>The <strong>pairing</strong> possesses the following <u>bilinear property:</u></p>

$$
\forall P,Q\in \mathbb{G}: e(P^x,Q^y)=e(P,Q)^{xy}
$$



<p>The pairing takes two elements in the base group $\mathbb{G}$ as inputs, and outputs an element of the target group.</p>
<p>For example, $e(g^x,g^y)=e(g,g)^{xy}=e(g^{xy},g)$.</p>
<p>By the CDH assumption, we know computing $g^{xy}$ is hard given $g^x$ and $g^y$. It means that computing the product in the exponent is hard.</p>
<p>But with pairing, we can <u>check</u> that some element $h=g^{xy}$ without knowing $x$ and $y$. </p>
<p>Note that with pairing, we <strong>cannot</strong> break the CDH assumption with pairing.</p>
<p>It actually gives us a tool to <u>verify the product relationship in the exponent</u> rather than computing the product in the exponent.</p>
<p>A pairing example is the BLS signature proposed by Boneh, Lynn, and Shacham in 2001. [<a target="_blank" rel="noopener" href="https://www.iacr.org/archive/asiacrypt2001/22480516.pdf">Bonth-Lynn-Shacham’2001</a>]</p>
<ul>
<li>$\text{Keygen}(p,\mathbb{G},g, \mathbb{G}_T,e):$ private key $x$ and public key $g^x$.</li>
<li>$\text{Sign}(sk,m)\rightarrow \sigma:H(m)^x$ where $H$ is a cryptographic hash that maps the message space to $\mathbb{G}$.</li>
<li>$\text{Verify}(\sigma, m):e(H(m),g^x)=e(\sigma,g)$</li>
</ul>
<p>The verification is to check the pairing equation.</p>
<p>The LHS is the pairing of the hash of the message and the public key. The verifier cannot compute $H(m)^x$ without knowing $x$.</p>
<p>The RHS is the pairing of the signature and the generator.</p>
<p><font color=blue><u><b><em>Security Analysis:</em></b></u></font> </p>
<p>The <strong>correctness</strong> holds since the verifier will pass if the signer honestly computes $H(m)^x$.</p>
<p>The idea of proving <strong>soundness</strong> is by contradiction.</p>
<p>Assuming there is an adversary that can forge a signature to pass the verification, then we can break CDH assumption using this bilinear group.</p>
<p>For your information, <strong>not all groups</strong> in which DL is hard are believed to <u>support efficient computable pairing,</u> but some groups especially those <u>defined by elliptic curves.</u></p>
<h1 id="KZG-based-on-Bilinear-Pairing"><a href="#KZG-based-on-Bilinear-Pairing" class="headerlink" title="KZG based on Bilinear Pairing"></a>KZG based on Bilinear Pairing</h1><p>Lecture 4 has introduced KZG polynomial commitment scheme [<a target="_blank" rel="noopener" href="https://www.iacr.org/archive/asiacrypt2010/6477178/6477178.pdf">Kate-Zaverucha-Goldberg’2010</a>] with the multiplication notation but omits the details of pairing.</p>
In this section, we use the exponent notation and consider a bilinear group defined by $p, \mathbb{G},g,\mathbb{G}_T,e$ and the univariate polynomials $\mathcal{F}=\mathbb{F}_p^{(\le d)}[X]$ with degree $\le d$.

<p>Note that the degree $d$ is public to the verifier.</p>
<h2 id="KZG-scheme"><a href="#KZG-scheme" class="headerlink" title="KZG scheme"></a>KZG scheme</h2><p>Let’s elaborate on the four algorithms one by one.</p>
<p><font color=blue><u><b>keygen</b></u></font> $(\lambda, \mathcal{F})\rightarrow gp$ : compute the global parameters</p>
<ul>
<li>$\text{keygen}(\lambda, \mathcal{F})\rightarrow gp$<ul>
<li>Sample random $\tau\in \mathbb{F}_p$</li>
<li>$gp=(g,g^\tau,g^{\tau^2},\dots, g^{\tau^d})$</li>
<li><font color=red> delete $\tau$ !! </font> (trusted setup)</li>
</ul>
</li>
</ul>
<p>Intuitively, it uses a group where <u>DL assumption is hard so that no one can compute $\tau$.</u></p>
<p>It suffices to use $gp$ to <u>commit and generate the proof</u> for the <strong>prover</strong>, and to <u>check the pairing equation</u> for the <strong>verifier</strong>, without knowing the secret $\tau$.</p>
<p>Once the prover learns the secret $\tau$, the prover can generate fake proof to fool the verifier and break the security of the polynomial commitment scheme.</p>
<p>It is worth noting that the secret $\tau$ should be deleted so that it <u>requires a trusted setup</u>, which is the main drawback of KZG.</p>
<p>For some practical applications, it is actually hard to find a trusted party to run a trusted setup.</p>
<p><font color=blue><u><b>commit</b></u></font> $(gp,f)\rightarrow \text{com}_f$</p>
<ul>
<li><p>$f(x)=f_0+f_1x+f_2x^2+\dots+f_d x^d$</p>
</li>
<li><p>$gp=(g,g^\tau,g^{\tau^2},\dots, g^{\tau^d})$</p>
</li>
<li><p>Compute the commitment using $gp$</p>


$$
\begin{aligned}\text{com}_f&=g^{f(\tau)} \\ &=g^{f_0+f_1\tau +f_2\tau^2+\dots+f_d \tau^d} \\ &=(g)^{f_0} \cdot (g^{\tau})^{f_1} \cdot (g^{\tau^2})^{f_2}\dots (g^{\tau^d})^{f_d} \end{aligned}
$$

​	

</li>
</ul>
<p><font color=blue><u><b>eval</b></u></font> $(gp,f,u)\rightarrow v,\pi$</p>
<ul>
<li>$f(x)-f(u)=(x-u)q(x)$ as $u$ is a root of $f(x)-f(u)$</li>
<li>Compute $q(x)$ and $\pi=g^{q(\tau)}$ using $gp$</li>
</ul>
<p>Note that the proof can be computed without accessing $\tau$ and the proof size is only one group element.</p>
<p>Finally, we are going to introduce the <strong>verification part</strong>, which is the highlight of KZG.</p>
<p>The <u>equation that the verifier wants to check</u> is $f(x)-f(u)=(x-u)q(x)$.</p>
<p>A <strong>naive idea</strong> is to <u>verify the equation at the point $\tau$ in the exponent on the base $g$.</u></p>

$$
g^{f(\tau)-f(u)}=g^{(\tau-u)q(\tau)}
$$



<p>Verify has <u>received</u> $\text{com}_f=g^{f(\tau)}$ as commitment to $f$, $\pi=g^{q(\tau)}$ as eval proof, and $v=f(u)$ as evaluation from an honest prover.</p>
<p>Verifier can <u>compute</u> $g^{(\tau-u)}$ and $g^{q(\tau)}$ using $gp$.</p>
<p>Unfortunately, <u>under CDH assumption,</u> the verifier <strong>cannot</strong> compute $g^{(\tau-u)q(\tau)}$, which is the product in the exponent.</p>
<p>The solution is <strong>pairing</strong>, which gives us a way to <u>check the relation in the exponent of the equation instead of computing it.</u></p>
<p><font color=blue><u><b>verify</b></u></font> $(gp,\text{com}_f,u,v,\pi)$</p>
<ul>
<li><p>Idea: check the equation at point $\tau$</p>
</li>
<li><p>Challenge: only know $g^{\tau-u}$ and $g^{q(\tau)}$</p>
</li>
<li><p>Solution: pairing!</p>
</li>
<li><p>Pairing!</p>


$$
\begin{aligned}e(\text{com}_f/g^v,g)&=e(g^{\tau-u},\pi) \\ e(g,g)^{f(\tau)-f(u)}&=e(g,g)^{(\tau-u)q(\tau)}\end{aligned}
$$

​	

</li>
</ul>
<p>With pairing, the verifier can <u>check the equation at the point $u$ in the exponent.</u></p>
<p>The complete protocol is depicted as follows.</p>
<img src="https://s1.ax1x.com/2023/07/25/pCXSlNj.png" alt="KZG" style="zoom:50%;" />

<h2 id="Properties-of-KZG"><a href="#Properties-of-KZG" class="headerlink" title="Properties of KZG"></a>Properties of KZG</h2><p>Let’s sum up the properties of KZG poly-commit.</p>
<p><font color=blue><u><b>Properties of KZG:</b></u></font></p>
<ul>
<li>Keygen: trusted setup!</li>
<li>Commit: $O(d)$ group exponentiations, $O(1)$ commitment size.</li>
<li>Eval: $O(d)$ group exponentiations where $q(x)$ can be <u>computed efficiently in linear time!</u><br>Note: The polynomial division algorithm with nearly linear time is referred to <a target="_blank" rel="noopener" href="http://people.csail.mit.edu/madhu/ST12/scribe/lect06.pdf">this Lecture</a>.</li>
<li>Proof size: $O(1)$, 1 group element.</li>
<li>Verifier time: $O(1)$, 1 pairing.</li>
</ul>
<h2 id="Powers-of-tau-Ceremony"><a href="#Powers-of-tau-Ceremony" class="headerlink" title="Powers-of-tau Ceremony"></a>Powers-of-tau Ceremony</h2><p>The main drawback of KZG is the requirement of a trusted setup.</p>
<p>A way to relax the trusted setup is <strong>Ceremony</strong> which <u>uses a distributed generation of $gp$</u> so that no one can reconstruct the trapdoor if at least one of the participants is honest and discards their secrets.</p>
<p>The main idea of distributed generation is using the product of secrets from all parties.</p>
<p>The first party generates global parameters $gp=(g^\tau,g^{\tau^2},\dots, g^{\tau^d})=(g_1,g_2,\dots, g_d)$.</p>
<p>Then the next party samples random $s$, and update</p>

$$
\begin{aligned}gp' &=(g_1',g_2',\dots, g_d')  \\ &=(g_1^s,g_2^{s^2},\dots, g_d^{s^d}) \\ &= (g^{\tau s},g^{(\tau s)^2},\dots, g^{(\tau s)^d})\end{aligned}
$$



<p>with secret $\tau\cdot s$.</p>
<p>It introduces a secret $s$ from updating /ma</p>
<p>Finally, if all parties are honest, then the above procedure can generate the global parameters with the product of secrets from all parties.</p>
<p>Meanwhile, it is required to <u>check the correctness of $gp’$.</u></p>
<p><font color=blue><u><b>Correctness of :</b></u></font></p>
<p>(See [<a target="_blank" rel="noopener" href="https://eprint.iacr.org/2022/1592">Nikolaenko-Ragsdale-Bonneau-Boneh’22</a>])</p>
<ol>
<li>The contributor knows $s$ s.t. $g_1’=(g_1)^s$.<br>It can be verified by the $\Sigma$ protocol.</li>
<li>$gp’$ consists of <u>consecutive powers</u> $e(g_i’,g_1’)=e(g’_{i+1},g)$, and $g_1’\ne 1$.</li>
</ol>
<p>Note that the check of $g_1’\ne 1$ guarantees that the next party <u>cannot remove the product of the preceding secrets and change it to 0.</u></p>
<h2 id="Security-Analysis"><a href="#Security-Analysis" class="headerlink" title="Security Analysis"></a>Security Analysis</h2><p>The <strong>completeness</strong> of KZG is evident.</p>
<p>The <strong>soundness</strong> of KZG is <u>based on the following assumption.</u></p>
 <article class="message is-info"> <div class="message-header"> 

<p><b> $q$-Strong Bilinear Diffie-Hellman ($q$-SBDH) assumption:</b></p>
 </div> <div class="message-body"> 

<p>Given $(p,\mathbb{G},g,\mathbb{G}_T,e)$ and $(g,g^\tau,g^{\tau^2},\dots, g^{\tau^d})$, cannot compute $e(g,g)^{\frac{1}{\tau-u}}$ for any $u$.</p>
 </div> </article> 

<p>There is an <a target="_blank" rel="noopener" href="https://eprint.iacr.org/2010/215.pdf">exposition</a> [Tanaka-Saito] of reductions among the $q$-strong Diffie-Hellman problem and related problems.</p>
<p>The $q$-SBDH problem is reducible to the CDH problem, so $q$-SBDH is a strictly stronger assumption.</p>
<p><font color=blue><u><b>Proof of Soundness:</b></u></font> (By Contradiction)</p>
Assume for contradiction that an adversary returns a wrong answer $v^*\ne f(u)$ but the fake proof $\pi^*$ pass the verification.

<p>Then we can break $q$-SBDH assumption, which arrives to a contradiction.</p>
<ul>
<li> $e(\text{com}_f/g^{v^*})=e(g^{\tau-u},\pi^*)$ 

<ul>
<li>The pairing equation of verification holds by assumption.</li>
</ul>
</li>
<li> $e(g^{f(\tau)-v^{*}},g)=e(g^{\tau-u},\pi^*)$ 
<ul>
<li><p><strong>Knowledge of Exponent (KoE) assumption</strong></p>
<p>  Later we are going to introduce the KoE assumption, which <u>proves that the prover necessarily knows</u> $f$ s.t. $\text{com}_f=g^{f(\tau)}$ rather than a random element.</p>
</li>
<li><p>Because a random element as the commitment cannot be written in $g^{f(\tau)}$ for some $f$.</p>
</li>
<li><p>By KoE assumption, it means the prover necessarily knows an explicit $f$ so prover can compute $f(u)$.</p>
</li>
</ul>
</li>
<li><p>Define $\delta=f(u)-v^*$, which is $\ne 0$ by assumption.</p>
<ul>
<li>This is the <strong>key idea</strong> of the proof that <u>decomposes $v^*$ to the correct answer $f(u)$ and $\delta$.</u></li>
</ul>
</li>
<li>$\Leftrightarrow e(g^{\color{red}{f(\tau)-f(u)+f(u)-v^*}},g)=e(g^{\tau-u},\pi ^*)$</li>
<li><p>$\Leftrightarrow e(g^{\color{red}{(\tau-u)q(\tau)+\delta}},g)=e(g^{\tau-u},\pi ^*)$</p>
</li>
<li><p>$\Leftrightarrow e(g,g)^{(\tau-u)q(\tau)+\delta}=e(g,\pi ^*)^{\tau-u}$</p>
</li>
<li><p>Then we can <u>extract the common factor $\tau-u$ and put them outside the pairing</u> to achieve our goal of computing$e(g,g)^{\frac{1}{\tau-u}}$.</p>
</li>
<li><p>$\Leftrightarrow e(g,g)^{\delta}=(e(g,\pi ^*)/e(g,g)^{q(\tau)})^{\tau-u}$</p>
</li>
<li><p>$\Leftrightarrow e(g,g)^{\frac{\delta}{\tau -u}}=e(g,\pi^*)/e(g^{q(\tau)},g)$</p>
<ul>
<li>which breaks $q$-SBDH assumption.</li>
</ul>
</li>
</ul>
<p>Then we are going to prove knowledge soundness by the knowledge of exponent assumption.</p>
<h2 id="Knowledge-of-Exponent-assumption"><a href="#Knowledge-of-Exponent-assumption" class="headerlink" title="Knowledge of Exponent assumption"></a>Knowledge of Exponent assumption</h2><p>In the above security proof, we assume that the prover necessarily knows $f$ such that $\text{com}_f=g^{f(\tau)}$ rather than a random element.</p>
<p>We make use of the Knowledge of Exponent (KoE) assumption to refine KZG protocol, achieving  knowledge soundness.</p>
<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>  I excerpt the following descriptions from <a target="_blank" rel="noopener" href="https://eprint.iacr.org/2004/008.pdf">[Bellare-Palacio’04]</a> to intuitively introduce the knowledge of exponent assumption. </div> </article>

<p>Let $q$ be a prime such that $2q+1$ is also prime (safe prime), and let $g$ be a generator of the order $q$ subgroup of $Z_{2q+1}^*$.</p>
<p>Suppose we are given input $q,g,g^a$ and <u>want to output a pair $(C,Y)$ such that $Y=C^a$.</u> </p>
<p><strong>One way</strong> to do this is to pick some $c\in \mathbb{Z}_q$, let $C=g^c$, and let $Y=(g^a)^c$. </p>
<p>Intuitively, it can be viewed as saying that <u>this is the “<strong>only</strong>” way to produce such a pair.</u> </p>
<p>The assumption captures this by saying that <u>any adversary outputting such a pair must “know” an exponent $c$ such that $g^c=C$.</u> </p>
<p>The formalization asks that there be an <strong>“extractor”</strong> that can return $c$.</p>
 <article class="message is-info"> <div class="message-header"> 

<p><strong>Knowledge of Exponent assumption :</strong> </p>
 </div> <div class="message-body"> 

<p>For any adversary $A$ that takes input $q,g,g^a$ and returns $(C,Y)$ with $Y=C^a$, there exists an “extractor” $\bar{A}$, which given the same inputs as $A$ returns $c$ such that $g^c=C$.</p>
 </div> </article> 

<h2 id="KZG-with-Knowledge-Soundness"><a href="#KZG-with-Knowledge-Soundness" class="headerlink" title="KZG with Knowledge Soundness"></a>KZG with Knowledge Soundness</h2><p>Having this assumption, we can refine the KZG protocol.</p>
<p>The <strong>goal</strong> is to prove that <u>prover necessarily “knows” an exponent $f(\tau)$</u> such that $\text{com}_f=g^{f(\tau)}$.</p>
<p>We’d like to <u>ask the prover to generate such a pair $g^{f(\tau)}$ and $g^{\alpha f(\tau)}$ given “ $gp$ and $(gp)^{\alpha}$”.</u></p>
<p>The sketch of design is as follows.</p>
<p><font color=blue><u><b>Sketch:</b></u></font></p>
<ul>
<li>$gp=(g,g^\tau,g^{\tau^2},\dots, g^{\tau^d})$</li>
<li>Sample random $\alpha$, compute $g^\alpha,g^{\alpha \tau},g^{\alpha \tau^2},\dots, g^{\alpha \tau^d}$</li>
<li>$\text{com}_f=g^{f(\tau)}$ and $\text{com}’_f=g^{\alpha f(\tau)}$.</li>
<li>If $e(\text{com}_f,g^\alpha)=e(\text{com}_f’,g)$, there exists an extractor $E$ that extracts $f$ s.t. $\text{com}_f=g^{f(\tau)}$.</li>
</ul>
<p>Let’s elaborate on the details.</p>
In addition to the original global parameters $gp$, we need to sample random $\alpha$ and compute $(gp)^\alpha:\{g^\alpha, g^{\alpha \tau}, g^{\alpha \tau^2},\dots, g^{\alpha\tau^d}\}$, which is raising each element of the original $gp$ to random $\alpha$.

<p>Note that the random $\alpha$ is <u>secret</u> as $\tau$.</p>
<p>The prover commits to $f$ by computing such a pair, $\text{com}_f=g^{f(\tau)}$ and $\text{com}_f’=g^{\alpha f(\tau)}$.</p>
<p>Finally, the verifier can <u>check the relation of these two commitments in the exponent by pairing.</u></p>
<p>If the pairing equation $e(\text{com}_f,g^\alpha)=e(\text{com}_f’,g)$ holds, by KoE assumption, there exists an extractor $E$ that extracts $f$ such that $\text{com}_f=g^{f(\tau)}$.</p>
<p>Here is the KZG scheme with knowledge soundness.</p>
<p><font color=blue><u><b>KZG with Knowledge Soundness:</b></u></font></p>
<ul>
<li>$\text{Keygen}$: $gp$ includes both $g,g^\tau,g^{\tau^2},\dots, g^{\tau^d}$ and $g^\alpha,g^{\alpha\tau},g^{\alpha\tau^2},\dots, g^{\alpha\tau^d}$ where $\tau$ and $r$ are both secret and required to be deleted. (trusted setup)</li>
<li>$\text{Commit}$: $\text{com}_f=g^{f(\tau)}$ and $\text{com}_f’=g^{\alpha f(\tau)}$.</li>
<li>$\text{Verify}$: additionally checks $e(\text{com}_f,g^\alpha)=e(\text{com}_f’,g)$.</li>
</ul>
<p>The idea of proving knowledge soundness is to extract $f$ in the first step by the KoE assumption.</p>
<p>But it brings an <strong>overhead</strong> that the <u>prove size</u> is two group elements and the <u>verifier time</u> involves two pairing equations.</p>
<p><strong>Generic Group Model (GGM)</strong> [Shoup’97, Maurer’05] can <u>replace the KoE assumption and reduce the commitment size in KZG.</u></p>
<p>Informally speaking, the adversary <u>is only given an oracle to compute the group operation.</u> E.g., given $g,g^\tau,g^{\tau^2},\dots, g^{\tau^d}$, the adversary can only compute their linear combinations.</p>
<p>As a result, the adversary cannot sample a random element that happens to be the power of another group element.</p>
<article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i> See book “A Graduate Course in Applied Cryptography” by Dan Boneh and Victor Shoup, section 16.3 for more details. </div> </article>

<h2 id="Variants-of-KZG"><a href="#Variants-of-KZG" class="headerlink" title="Variants of KZG"></a>Variants of KZG</h2><h3 id="Multivariate-poly-commit"><a href="#Multivariate-poly-commit" class="headerlink" title="Multivariate poly-commit"></a>Multivariate poly-commit</h3><article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>  Reference:  <a target="_blank" rel="noopener" href="https://eprint.iacr.org/2011/587"> [Papamanthou-Shi-Tamassia’13]</a> </div> </article>

<p>KZG can be generalized to the multivariate polynomial commitment.</p>
<p>The <strong>key idea</strong> is the following equation:</p>

$$
f(x_1,\dots, x_k)-f(u_1,\dots,u_k)=\sum_{i=1}^k (x_i-u_i) q_i(\vec{x})
$$



<p>where $q(\vec{x})$ is a multivariate polynomial.</p>
<ul>
<li><strong>Keygen</strong>: sample $\tau_1,\tau_2,\dots, \tau_k$, each representing one variable, and compute $gp$ as $g$ raised to all possible monomials of $\tau_1,\tau_2,\dots, \tau_k$.<br>e.g. $2^k$ monomials for multilinear polynomials.</li>
<li><strong>Commit</strong>: $\text{com}=g^{f(\tau_1,\tau_2,\dots, \tau_k)}$</li>
<li><strong>Eval</strong>: compute $\pi_i=g^{q_i(\vec{\tau})}$.<br>Note that the proof consists of multiple elements.</li>
<li><strong>Verify</strong>: $e(\text{com}_f/g^v,g)=\prod_{i=1}^ke(g^{\tau_i-u_i},\pi_i)$ </li>
</ul>
<p>Let $N\le 2^k$ denote the total size of the polynomial.</p>
<p>The <u>proof size and verifier time</u> are $O(\log N)$.</p>
<h3 id="Achieving-zero-knowledge"><a href="#Achieving-zero-knowledge" class="headerlink" title="Achieving zero-knowledge"></a>Achieving zero-knowledge</h3><article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>  Reference: [ZGKPP’2018] </div> </article>

<p>We say a poly-commit scheme is ZK if there is a simulator without knowing the polynomial can simulate the view of the verifier.</p>
<p>The <u>plain KZG is not ZK.</u> E.g. the commit algorithm $\text{com}_f=g^{f(\tau)}$ is <u>deterministic</u>. </p>
<p>The <strong>solution to achieve zero-knowledge</strong> is <u>masking the commitment and proof with randomizers.</u> </p>
<ul>
<li><strong>Commit</strong>: $\text{com}_f=g^{f(\tau)+r\eta}$</li>
<li><strong>Eval</strong>: the main idea is to check <u>whether a polynomial with randomizers is of a certain form.</u><ul>
<li><strong>bivariate polynomial with randomizer:</strong> $\begin{aligned} f(x)+ry-f(u) =(x-u)(q(x)+r’y)+y(r-r’(x-u))\end{aligned}$</li>
<li><strong>proof</strong>: $\pi=g^{q(\tau)+r’\eta},g^{r-r’(\tau-u)}$</li>
</ul>
</li>
</ul>
<p>Let’s elaborate on the details.</p>
<p>First look at the <strong>commitment</strong> $\text{com}_f=g^{f(\tau)+r\eta}$.</p>
<p>The commitment to $f$ is <u>randomized by $r$ randomly chosen by the prover.</u></p>
<p>Note that  $\eta$ is another <u>secret sampled in the trusted setup</u> so $g^\eta$ is <u>included in the global parameters</u>, which enables the prover to compute it.</p>
<p>With random $r$ in the commitment, the <strong>idea of evaluation</strong> is to <u>check the randomized bivariate polynomial is of a certain form:</u> </p>
<p>$$<br>\begin{aligned} f(x)+ry-f(u) =(x-u)(q(x)+r’y)+y(r-r’(x-u))\end{aligned}<br>$$</p>
<p>Likewise the check $f(x)-f(u)=(x-u)q(x)$ in the univariate polynomial, we can <u>check the above relation in the exponent with pairing</u> yet it is split into two terms of products.</p>
<p>Consequently, the proof consists of <u>two elements,</u> the first evaluating $q(x)+r’y$ and the second evaluating $r-r’(x-u)$ at point $(x=\tau,y=\eta)$.</p>
<p>Note that the verifier can compute $g^{\tau-u}$ and $g^\eta$ using $gp$.</p>
<p>Finally, the verifier can check the relation in the pairing equation.</p>
<h3 id="Batch-opening-single-polynomials"><a href="#Batch-opening-single-polynomials" class="headerlink" title="Batch opening: single polynomials"></a>Batch opening: single polynomials</h3><p>Another variant of KZG is <strong>batch opening</strong> or <strong>batch proofs</strong>.</p>
<p>Let’s consider the <u>batch proofs for a single polynomial</u> in which the prover wants to prove $f$ at $u_1,\dots, u_m$ for $m&lt;d$.</p>
<p>Note that $m&lt;d$ is necessary since $m (&gt;d)$ points can interpolate the polynomial in clear.</p>
<p>The key idea is to extrapolate $f(u_1),\dots, f(u_m)$ to get $h(x)$ such that $h(u_i)=f(u_i)$.</p>
<p>Recall that in Lecture 5 we introduce a vanishing polynomial in <u>ZeroTest on the set $\Omega$.</u> </p>
<p>It’s actually the same that we can <u>prove $f(x)-h(x)=0$ on the set ${u_1,\dots, u_m}$ using ZeroTest:</u></p>
<p>$$<br>f(x)-h(x)=\prod_{i=1}^m (x-u_i) q(x)<br>$$</p>
<p>$f(x)-h(x)$ is zero over the set ${u_1,\dots, u_m}$ if and only if it is divisible by the vanishing polynomial $\prod_{i=1}^m (x-u_i)$.</p>
<p>The <strong>prover</strong> needs to compute the quotient polynomial $q(x)$ and generates the proof $\pi =g^{q(\tau)}$, a single group element as the batch proofs.</p>
<p>The <strong>verifier</strong> checks the pairing equation</p>
 
$$
e(\text{com}_f/g^{h(\tau)},g)=e(g^{\prod_{i=1}^m(\tau-u_i)},\pi)
$$



<p>where $g^{h(\tau)}$ and $g^{\prod_{i=1}^m(\tau-u_i)}$ can be computed using $gp$.</p>
<p>Note that the <u>proof size is only one group element</u> but the <u>verifier time grows linearly in the number of evaluations.</u></p>
<h3 id="Batch-opening-multiple-polynomials"><a href="#Batch-opening-multiple-polynomials" class="headerlink" title="Batch opening: multiple polynomials"></a>Batch opening: multiple polynomials</h3><p>Then we extend <u>batch opening for multiple polynomials (and multiple evaluations)</u> where the prover wants to prove $f_i(u_{i,j})=v_{i,j}$ for $i\in [n]$, $j\in [m]$.</p>
<p>The <strong>key idea</strong> kind of similar to the single polynomial case that <u>extrapolates multiple polynomials</u>. Specifically, the extrapolates $f_i(u_1),\dots, f_i(u_m)$ to get $h_i(x)$ for each $i\in [n]$.</p>
<p>For each polynomial, we have $f_i(x)-h_i(x)=\prod_{i=1}^m (x-u_m)q_i(x)$.</p>
<p>The prover needs to <u>compute every quotient polynomial $q_i(x)$ combine them via a random linear combination.</u></p>
<p>Then prover can compute the <strong>proof</strong> <u>as $g$ to the equation of the random linear combination, which</u> is a <u>single element</u>.</p>
<p>The verifier can check the relation in the exponent using bilinear pairing.</p>
<hr>
<p>KZG and its variants play an important role in building SNARKs.</p>
<p>Plonk poly-IOP is combined with the univariate version of KZG to build SNARK for general circuits.</p>
<img src="https://s1.ax1x.com/2023/07/26/pCj8ax1.png" alt="Plonk" style="zoom:33%;" />

<p>vSQL and Libra both combine the Sumcheck protocol (Lecture 4) and the multivariate KZG.</p>
<img src="https://s1.ax1x.com/2023/07/26/pCj8U2R.png" alt="vSQL, Libra" style="zoom:33%;" />

<hr>
<p>Before ending up discussing the poly-commit scheme based on the bilinear pairing, let’s sum up the <strong>pros and cons</strong> of KZG poly-commit.</p>
<p>The <strong>pros</strong> contains that the <u>commitment and proof size</u> is $O(1)$, 1 group element and the <u>verifier time</u> involves $O(1)$ pairing.</p>
<p>The main <strong>cons</strong> is that KZG <u>requires a trusted setup</u> to generate $gp$.</p>
<p>The <u>trusted setup is a fundamental problem</u> to solve although the ceremony process relaxes trust a little bit and it is good for many applications in practice.</p>
<h1 id="Bulletproofs-based-on-discrete-log"><a href="#Bulletproofs-based-on-discrete-log" class="headerlink" title="Bulletproofs based on discrete-log"></a>Bulletproofs based on discrete-log</h1><p>Bulletproofs is proposed by [<a target="_blank" rel="noopener" href="https://eprint.iacr.org/2017/1066.pdf">BCCGP’16</a>] and refined by [BBBPWM’18] to build SNARKs using a transparent setup.</p>
<p>Moreover, they proposed an inner product protocol and a special protocol for range proof that can be generalized to build SNARKs for a general arithmetic circuit.</p>
<h2 id="Poly-commit-based-on-Bulletproofs"><a href="#Poly-commit-based-on-Bulletproofs" class="headerlink" title="Poly-commit based on Bulletproofs"></a>Poly-commit based on Bulletproofs</h2><p>In this section, we <u>rephrase the Bulletproofs as a poly-commit</u> because it still shows the key idea of the reduction but significantly simplifies the protocol.</p>
<p>The <strong>transparent setup</strong> samples random $gp=(g_0,g_1,g_2,\dots, g_d)\in \mathbb{G}$ <u>without the trapdoor</u> $\tau$ whose size is still linear to the degree $d$.</p>
<p>The prover <strong>commits</strong> to $f(x)=f_0+f_1x+f_2x^2+\dots +f_dx^d$ as usual, which <u>raises each element of $gp$ to the corresponding</u> coefficients of the polynomials and multiply them together to get a <u>single element.</u></p>
<p>$$<br>\text{com}_f=g_0^{f_0}g_1^{f_1}g_2^{f_2}\dots g_d^{f_d}<br>$$</p>
<p>Note that the random term is omitted.</p>
<p>Let’s describe the <strong>high-level idea of Bulletproofs reduction</strong> using <u>an example of a degree-3 polynomial.</u></p>
<p>After receiving the commitment to $f$ from the prover, verifier queries at $u$. Prover replies with the evaluation $v$.</p>
<p>The <strong>key idea</strong> is to <u>reduce the claim of evaluating $v$ at point $u$ for the polynomial $f$</u> inside the commitment $\text{com}_f$ to <u>a new claim about a new polynomial of only half of the size.</u></p>
<p>In our example, we reduce the original polynomial of degree 3 to a new polynomial of degree only 1 with only two coefficients $f_0’$ and $f_1’$.</p>
<p>Furthermore, the verifier will receive a new instance of the commitment $\text{com}_{f’}$ to this new polynomial of only half of the size.</p>
<p>Then we <u>keep doing recursively</u> to reduce the polynomial of degree $d/2$ to a new polynomial of degree $d/4,d/8,\dots,$  to a constant degree.</p>
<p>Finally, <u>in the last round,</u> the <strong>prover</strong> can <u>just send a polynomial of constant size to the verifier directly</u>, and the <strong>verifier</strong> <u>opens the polynomial and checks the evaluation</u> of the last round is indeed true.</p>
<p>It completes the entire reduction and guarantees that the claim of the evaluation of $v$ for the original polynomial is correct.</p>
<p>The main <strong>challenge of the reduction</strong> is how to <u>go from the original polynomial to a new polynomial of half of the size.</u></p>
<p>We<font color=red> <b>can’t have</b> </font> the <u>prover commit to a random polynomial of half of the size without any relationship.</u> Otherwise, the prover can cheat and lie about the evaluation since this new polynomial has no relation to the original polynomial.</p>
<p>It <u>has to check the relationship between the two polynomials.</u></p>
<img src="https://s1.ax1x.com/2023/07/26/pCj8J54.png" alt="High-level idea" style="zoom:43%;" />



<p>Let’s elaborate on the details of the reduction.</p>
<p><strong>Prover</strong> first sends the evaluation $v=f_0+f_1u+f_2u^2+f_3u^3$ at point $u$.</p>
<p>A <strong>common way of reduction for the prover</strong> is reducing the polynomial to two polynomials of half of size. </p>
<p>Then <strong>prover</strong> <u>evaluates these two reduced polynomials</u> at point $u$ to get $v_L=f_0+f_1u$ and $v_R=f_2+f_3u$ such that $v=v_L+v_Ru^2$.</p>
<p>It is safe for the <strong>verifier</strong> to <u>believe that $v$ is the correct evaluation if and only if $v_L$ and $v_R$ are correctly evaluated for the reduced polynomials.</u></p>
<p>So <strong>prover</strong> also <u>commits to the two reduced polynomials</u> with two cross terms $L=g_2^{f_0}g_3^{f_1}$ and $R=g_0^{f_2}g_1^{f_3}$, which uses $g_2,g_3$ as bases to commit to the left reduced polynomial and $g_0,g_1$ to commit to the right reduced polynomial. </p>
<p>As depicted follows, prover sends two commitments $L$ and $R$  and two evaluations $v_L$ and $v_R$ on the two reduced polynomials.</p>
<img src="https://s1.ax1x.com/2023/07/26/pCj8NG9.png" alt="Poly-commitment based on Bulletproofs" style="zoom:45%;" />



<p>But these two polynomials are <u>actually temporary reduced polynomials.</u></p>
<p>The <strong>actual reduced polynomial</strong> is <u>a single polynomial with two coefficients</u> $rf_0+f_2$ and $rf_1+f_3$, which is <u>a randomized linear combination</u> of the original coefficients where the <u>randomness $r$ is sampled by the verifier.</u></p>
<p>This <strong>new claim</strong> <strong>about this new reduced polynomial</strong> actually <u>combines two claims about the old temporary polynomials</u> through randomized linear combinations.</p>
<p>And the <strong>claim</strong> <strong>about the evaluation</strong> <u>in the next round</u> is to altered to $v’=rv_L+v_R$.</p>
<p>The only <strong>remaining challenge</strong> is to <u>generate the commitment</u> of this randomized reduced polynomial.</p>
<p>We <font color=red> can’t </font> let the prover commit $g_0^{rf_0+f_2}g_1^{rf_1+f_3}$ with the original global parameters because the <u>transparent setup doesn’t know the relationship ( defined by $r$ )</u> between the two polynomials.</p>
<p>In order to address the issue, Bulletproofs proposed a clever design to allow the verifier to compute the new commitment from the old commitments with the help of the commitments to the temporary polynomials.</p>
<p>Recall that $\text{com}_f=g_0^{f_0}g_1^{f_1}g_2^{f_2}\dots g_d^{f_d}$, $L=g_2^{f_0}g_3^{f_1}$ and $R=g_0^{f_2}g_1^{f_3}$. Then <strong>verifier</strong> can <u>compute the commitment</u> $\text{com}’$ from $L$ and $R$ such that </p>

$$
\begin{aligned} \text{com}' &=L^r\cdot \text{com}_f \cdot R^{r^{-1}}  \\ &=g_0^{f_0+r^{-1}f_2}g_2^{rf_0+f_2}\cdot g_1^{f_1+r^{-1}f_3}g_3^{rf_1+f_3} \\ &= (g_0^{r^{-1}}g_2)^{rf_0+f_2} \cdot (g_1^{r^{-1}}g_3)^{rf_1+f_3}\end{aligned}
$$



<p>where the global parameter is updated to $gp’=(g_0^{r^{-1}}g_2,g_1^{r^{-1}}g_3)$.</p>
<p>The <u>last equation holds by extracting the common factor</u> to commit to the new polynomial with coefficients $rf_0+f_2$ and $rf_1+f_3$.</p>
<p>And the verifier can compute the new global parameters related to the new commitment, which allows the verifier to check some pairing equations. </p>
<p>Let’s sum up the reduction procedure.</p>
<p><font color=blue><u><b>Poly-commitment based on Bulletproofs:</b></u></font></p>
<p><u><b><i>Recurse $\log d$ rounds:</i></b></u> </p>
<ul>
<li>Eval: (Prover)<ol>
<li>Compute $L,R,v_L,v_R$</li>
<li>Receive $r$ from the verifier, reduce $f$ to $f’$ of degree $d/2$</li>
<li>Update the bases $gp’$</li>
</ol>
</li>
<li>Verify: (Verifier)<ol>
<li>Check $v=v_L+v_Ru^{d/2}$</li>
<li>Generate $r$ randomly</li>
<li>Update $\text{com}’=L^r\cdot \text{com}_f\cdot R^{r^{-1}}$, $gp’$, and $v’=rv_L+v_R$</li>
</ol>
</li>
</ul>
<p><u><b><i>In the last round:</i></b></u> </p>
<ol>
<li>The prover sends the constant-size polynomial to the verifier.</li>
<li>The verifier checks the commitment and the evaluation is correct.</li>
</ol>
<p>Note that the above protocol can be rendered non-interactive via Fiat Shamir.</p>
<h2 id="Properties-of-Bulletproofs"><a href="#Properties-of-Bulletproofs" class="headerlink" title="Properties of Bulletproofs"></a>Properties of Bulletproofs</h2><p>Let’s sum up the properties of poly-commitment based on Bulletproofs.</p>
<p><font color=blue><u><b>Properties of Bulletproofs:</b></u></font> </p>
<ul>
<li>Keygen: $O(d)$, transparent setup!</li>
<li>Commit: $O(d)$ group exponentiations, $O(1)$ commitment size.</li>
<li>Eval: $O(d)$ group exponentiations</li>
<li>Proof size: $O(\log d)$<br>In each round, the prover sends 4 elements as proof.</li>
<li>Verifier time: $O(d)$<br>The verifier has to recursively update the global parameters the number of which falls geometrically so the verifier time depends on the first round that is nearly linear in $d$.</li>
</ul>
<h1 id="Other-works"><a href="#Other-works" class="headerlink" title="Other works"></a>Other works</h1><h2 id="Hyrax"><a href="#Hyrax" class="headerlink" title="Hyrax"></a>Hyrax</h2><article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>  Reference: [Wahby-Tzialla-shelat-Thaler-Walfish’18] </div> </article>

<p>The <strong>main drawback</strong> of Bulletproofs is the <u>linear verifier time.</u></p>
<p>Hyrax improves the <u>verifier time</u> to $O(\sqrt{d})$ by representing the coefficients as a 2-D matrix with <u>proof size</u> $O(\sqrt{d})$.</p>
<p>In fact, the product of verifier time and the proof size is linear in $d$ so the proof size can be reduced to $\sqrt[n]{d}$ while the verifier time is $d^{1-1/n}$.</p>
<h2 id="Dory"><a href="#Dory" class="headerlink" title="Dory"></a>Dory</h2><article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>  Reference: [Lee’2021] </div> </article>

<p>Dory improves the <u>verifier time</u> to $O(\log d)$ <u>without any asymptotic overhead on other parts.</u></p>
<p>It’s a nice improvement over the poly-commitment based on Bulletproofs.</p>
<p>The <strong>key idea</strong> is <u>delegating the structured verifier computation to the prover</u> using inner pairing product arguments. [BMMTV’2021]</p>
<p>It also improves the prover time to $O(\sqrt{d})$ exponentiations plus $O(d)$ field operations.</p>
<h2 id="Dark"><a href="#Dark" class="headerlink" title="Dark"></a>Dark</h2><article class="message message-immersive is-primary"> <div class="message-body"> <i class="fas fa-info-circle mr-2"></i>  Reference: [Bünz-Fisch-Szepieniec’20] </div> </article>

<p>Dark achieves $O(\log d)$ proof size and verifier time based on the cryptographic primitive of group of unknown order.</p>
<hr>
<p>Let’s end up with a summary of all works mentioned in this lecture.</p>
<img src="https://s1.ax1x.com/2023/07/26/pCj8tPJ.png" alt="Summary of PCS" style="zoom:33%;" /></div><div class="article-licensing box"><div class="licensing-title"><p>「Cryptography-ZKP」: Lec6 Poly-commit based on Pairing and Discret-log</p><p><a href="https://f7ed.com/2023/07/26/zkp-lec6/">https://f7ed.com/2023/07/26/zkp-lec6/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>f7ed</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2023-07-26</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-07-27</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a><a class="icons" rel="noopener" target="_blank" title="Share Alike" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><i class="icon fab fa-creative-commons-sa"></i></a><a class="" rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></p></div></div></div></div></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/Cryptography/">Cryptography, </a><a class="link-muted" rel="tag" href="/tags/ZKP/">ZKP, </a><a class="link-muted" rel="tag" href="/tags/Poly-commit/">Poly-commit, </a><a class="link-muted" rel="tag" href="/tags/Bulletproofs/">Bulletproofs, </a><a class="link-muted" rel="tag" href="/tags/KZG/">KZG </a></div></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/img/qrcode_wechat.jpg" alt="Wechat"></span></a><a class="button donate" href="https://www.buymeacoffee.com/f7ed" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/img/qrcode_alipay.jpg" alt="Alipay"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2023/08/02/zkp-lec7/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">「Cryptography-ZKP」: Lec7 Poly-commit based on ECC</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2023/07/21/zkp-lec5/"><span class="level-item">「Cryptography-ZKP」: Lec5-The Plonk SNARK</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "42e1634b70f9e0b304ca99cadaad220a",
            repo: "f7ed.github.io",
            owner: "f7ed",
            clientID: "ec59f5258ac0ec443907",
            clientSecret: "f092b308c3e1b46327481c3547ee0dd7fc1bda10",
            admin: ["f7ed"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "en",
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/profile.png" alt="f7ed"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">f7ed</p><p class="is-size-6 is-block">热爱可抵漫长岁月。</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Shanghai, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">71</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">15</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">139</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="mailto:f7edliu@outlook.com" target="_blank" rel="noopener">Email me</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/f7ed"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Background"><span class="level-left"><span class="level-item">1</span><span class="level-item">Background</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Discrete-log"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Discrete-log</span></span></a></li><li><a class="level is-mobile" href="#Bilinear-Pairing"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">Bilinear Pairing</span></span></a></li></ul></li><li><a class="level is-mobile" href="#KZG-based-on-Bilinear-Pairing"><span class="level-left"><span class="level-item">2</span><span class="level-item">KZG based on Bilinear Pairing</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#KZG-scheme"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">KZG scheme</span></span></a></li><li><a class="level is-mobile" href="#Properties-of-KZG"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Properties of KZG</span></span></a></li><li><a class="level is-mobile" href="#Powers-of-tau-Ceremony"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">Powers-of-tau Ceremony</span></span></a></li><li><a class="level is-mobile" href="#Security-Analysis"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">Security Analysis</span></span></a></li><li><a class="level is-mobile" href="#Knowledge-of-Exponent-assumption"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">Knowledge of Exponent assumption</span></span></a></li><li><a class="level is-mobile" href="#KZG-with-Knowledge-Soundness"><span class="level-left"><span class="level-item">2.6</span><span class="level-item">KZG with Knowledge Soundness</span></span></a></li><li><a class="level is-mobile" href="#Variants-of-KZG"><span class="level-left"><span class="level-item">2.7</span><span class="level-item">Variants of KZG</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Multivariate-poly-commit"><span class="level-left"><span class="level-item">2.7.1</span><span class="level-item">Multivariate poly-commit</span></span></a></li><li><a class="level is-mobile" href="#Achieving-zero-knowledge"><span class="level-left"><span class="level-item">2.7.2</span><span class="level-item">Achieving zero-knowledge</span></span></a></li><li><a class="level is-mobile" href="#Batch-opening-single-polynomials"><span class="level-left"><span class="level-item">2.7.3</span><span class="level-item">Batch opening: single polynomials</span></span></a></li><li><a class="level is-mobile" href="#Batch-opening-multiple-polynomials"><span class="level-left"><span class="level-item">2.7.4</span><span class="level-item">Batch opening: multiple polynomials</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#Bulletproofs-based-on-discrete-log"><span class="level-left"><span class="level-item">3</span><span class="level-item">Bulletproofs based on discrete-log</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Poly-commit-based-on-Bulletproofs"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Poly-commit based on Bulletproofs</span></span></a></li><li><a class="level is-mobile" href="#Properties-of-Bulletproofs"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">Properties of Bulletproofs</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Other-works"><span class="level-left"><span class="level-item">4</span><span class="level-item">Other works</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Hyrax"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">Hyrax</span></span></a></li><li><a class="level is-mobile" href="#Dory"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">Dory</span></span></a></li><li><a class="level is-mobile" href="#Dark"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">Dark</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/f1ed_logo.png" alt="fred&#039;s blog" height="28"></a><p class="is-size-7"><span>&copy; 2025 f7ed</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent " target="_blank" rel="noopener" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="f7ed&#039;s GitHub" href="https://github.com/f7ed"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script>
      var sc_project=12961083;
      var sc_invisible=1;
      var sc_security="ad3fb575";
      var sc_https=1;
      var sc_remove_link=1;</script><script src="https://www.statcounter.com/counter/counter.js" async></script><noscript><div class="statcounter"><img class="statcounter" src="https://c.statcounter.com/12961083/0/ad3fb575/1/" alt="real time web analytics"></div></noscript><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>